!!!
%html
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %title= content_for(:title) || "Das Club"
    %meta{:content => "width=device-width,initial-scale=1", :name => "viewport"}/
    %meta{:content => "yes", :name => "apple-mobile-web-app-capable"}/
    %meta{:content => "yes", :name => "mobile-web-app-capable"}/
    = csrf_meta_tags
    = csp_meta_tag
    = yield :head
    %link{:href => "/icon.png", :rel => "icon", :type => "image/png"}/
    %link{:href => "/icon.svg", :rel => "icon", :type => "image/svg+xml"}/
    %link{:href => "/icon.png", :rel => "apple-touch-icon"}/
    = stylesheet_link_tag :app, "data-turbo-track": "reload"
    = javascript_importmap_tags
    / Tailwind is built locally via tailwindcss-rails (no CDN)
  %body.bg-beige.text-brown-black.min-h-screen
    / Global Announcement Bar
    .bg-black.text-white.py-2.px-4.text-center
      %p.text-sm.font-medium ðŸŽ‰ Welcome to Das Club! Free shipping on abaya orders over $100 ðŸŽ‰
    %nav.bg-beige.shadow-lg
      .max-w-7xl.mx-auto.px-4.sm:px-6.lg:px-8
        .flex.justify-between.items-center.h-16
          / Logo
          .flex.items-center
            = link_to root_path, class: "group" do
              %span.text-3xl.font-black.text-brown-black.tracking-tight.relative.inline-block
                %span.inline-block.transition-transform.duration-300.group-hover:scale-110 D
                %span.inline-block.mx-1.text-amber-600.transition-all.duration-300.group-hover:text-amber-700 A
                %span.inline-block.transition-transform.duration-300.group-hover:scale-110 S
              %span.ml-2.text-xs.font-semibold.text-gray-500.uppercase.tracking-widest Club
          / Center Navigation Menu
          .hidden.md:flex.items-center.space-x-8
            = link_to "Home", root_path, class: "text-brown-black hover:text-amber-700 px-3 py-2 rounded-md text-sm font-medium transition-colors"
            
            / Collection Dropdown
            .relative{ data: { controller: "dropdown" } }
              %button{ type: "button", data: { action: "click->dropdown#toggle", dropdown_target: "button" }, class: "flex items-center gap-1 text-brown-black hover:text-amber-700 px-3 py-2 rounded-md text-sm font-medium transition-colors", aria: { haspopup: "true", expanded: "false" } }
                %span Collection
                %svg.w-4.h-4{ fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" }
                  %path{ d: "M19 9l-7 7-7-7", "stroke-linecap": "round", "stroke-linejoin": "round", "stroke-width": "2" }
              .absolute.left-0.mt-2.w-56.bg-white.border.border-gray-100.rounded-xl.shadow-xl.hidden.opacity-0.translate-y-2.transition-all.duration-200.z-50{ data: { dropdown_target: "panel" } }
                %ul.py-2
                  %li
                    = link_to "All Products", products_path, class: "block px-4 py-2 text-sm text-gray-700 hover:bg-amber-50 hover:text-amber-700 transition-colors"
                  - if @nav_categories.present?
                    %li.border-t.border-gray-100.my-1
                    - @nav_categories.each do |category|
                      %li
                        = link_to category, products_path(category: category), class: "block px-4 py-2 text-sm text-gray-700 hover:bg-amber-50 hover:text-amber-700 transition-colors"
            
            = link_to "About", "#about", class: "text-brown-black hover:text-amber-700 px-3 py-2 rounded-md text-sm font-medium transition-colors"
            = link_to "Contact", "#contact", class: "text-brown-black hover:text-amber-700 px-3 py-2 rounded-md text-sm font-medium transition-colors"
          / Right Side - Search and Shop
          .flex.items-center.space-x-4
            / Search Button
            %button.text-brown-black.hover:text-amber-700.p-2.rounded-md.transition-colors{:onclick => "toggleSearch()"}
              %svg.w-5.h-5{:fill => "none", :stroke => "currentColor", :viewbox => "0 0 24 24"}
                %path{:d => "M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z", "stroke-linecap" => "round", "stroke-linejoin" => "round", "stroke-width" => "2"}
            - if user_signed_in?
              / User Menu Dropdown
              .relative.z-50{ data: { controller: "dropdown" } }
                %button{ type: "button", data: { action: "click->dropdown#toggle", dropdown_target: "button" }, class: "flex items-center gap-2 text-sm font-medium text-brown-black bg-white/60 border border-transparent hover:border-purple-200 px-3 py-2 rounded-md transition-all duration-300", aria: { haspopup: "true", expanded: "false" } }
                %span.text-xs.font-semibold.text-gray-500.uppercase.tracking-wide Welcome
                %span.text-brown-black.font-semibold= current_user.email.split('@').first.titleize
                %svg.w-4.h-4.text-gray-500{ fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" }
                  %path{ d: "M19 9l-7 7-7-7", "stroke-linecap": "round", "stroke-linejoin": "round", "stroke-width": "2" }
                .absolute.right-0.mt-2.w-56.bg-white.border.border-purple-100.rounded-xl.shadow-xl.hidden.opacity-0.translate-y-2.transition-all.duration-200.z-50{ data: { dropdown_target: "panel" } }
                  .px-4.py-3.border-b.border-purple-50
                    %p.text-xs.font-semibold.text-gray-500.uppercase.tracking-wide Account
                    %p.text-sm.text-brown-black.truncate= current_user.email
                  %ul.py-2
                    %li
                      = link_to profile_path, class: "flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-700 transition-colors" do
                        %svg.w-4.h-4{ fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" }
                        %path{ d: "M5.121 17.804A13.937 13.937 0 0112 15c2.5 0 4.847.655 6.879 1.804M15 11a3 3 0 11-6 0 3 3 0 016 0z", "stroke-linecap": "round", "stroke-linejoin": "round", "stroke-width": "2" }
                        %span Profile
                    %li
                      = link_to destroy_user_session_path, data: { turbo_method: :delete }, class: "flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors" do
                        %svg.w-4.h-4{ fill: "none", stroke: "currentColor", viewBox: "0 0 24 24" }
                        %path{ d: "M17 16l4-4m0 0l-4-4m4 4H7", "stroke-linecap": "round", "stroke-linejoin": "round", "stroke-width": "2" }
                        %span Sign Out
              / Cart Button (after dropdown)
              = render "layouts/cart_button"
            - else
              = link_to "Shop", products_path, class: "bg-brown-black text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-800 transition-colors"
              .flex.items-center.space-x-2
                = link_to "Sign In", new_user_session_path, class: "text-brown-black hover:text-amber-700 px-3 py-2 rounded-md text-sm font-medium transition-colors"
                = link_to "Sign Up", new_user_registration_path, class: "bg-amber-600 text-white hover:bg-amber-700 px-3 py-2 rounded-md text-sm font-medium transition-colors"
        / Mobile Menu
        .md:hidden
          .px-2.pt-2.pb-3.space-y-1.sm:px-3
            = link_to "Home", root_path, class: "text-brown-black hover:text-amber-700 block px-3 py-2 rounded-md text-base font-medium"
            = link_to "Collection", products_path, class: "text-brown-black hover:text-amber-700 block px-3 py-2 rounded-md text-base font-medium"
            - if @nav_categories.present?
              - @nav_categories.each do |category|
                = link_to category, products_path(category: category), class: "text-gray-600 hover:text-amber-700 block px-6 py-2 rounded-md text-sm font-medium"
            = link_to "About", "#about", class: "text-brown-black hover:text-amber-700 block px-3 py-2 rounded-md text-base font-medium"
            = link_to "Contact", "#contact", class: "text-brown-black hover:text-amber-700 block px-3 py-2 rounded-md text-base font-medium"
            - if user_signed_in?
              = link_to "My Profile", profile_path, class: "text-brown-black hover:text-amber-700 block px-3 py-2 rounded-md text-base font-medium"
              = link_to "Sign Out", destroy_user_session_path, data: { turbo_method: :delete }, class: "text-red-600 hover:text-red-700 block px-3 py-2 rounded-md text-base font-medium"
            - else
              = link_to "Sign In", new_user_session_path, class: "text-brown-black hover:text-amber-700 block px-3 py-2 rounded-md text-base font-medium"
              = link_to "Sign Up", new_user_registration_path, class: "text-brown-black hover:text-amber-700 block px-3 py-2 rounded-md text-base font-medium"
    / Search Overlay
    #searchOverlay.fixed.inset-0.bg-black.bg-opacity-50.z-50.hidden
      .flex.items-center.justify-center.min-h-screen.p-4
        .bg-white.rounded-lg.p-6.w-full.max-w-md
          .flex.items-center.justify-between.mb-4
            %h3.text-lg.font-semibold.text-brown-black Search Products
            %button.text-gray-500.hover:text-gray-700{:onclick => "toggleSearch()"}
              %svg.w-6.h-6{:fill => "none", :stroke => "currentColor", :viewbox => "0 0 24 24"}
                %path{:d => "M6 18L18 6M6 6l12 12", "stroke-linecap" => "round", "stroke-linejoin" => "round", "stroke-width" => "2"}
          = form_with url: products_path, method: :get, local: true, class: "flex gap-2" do |form|
            = form.text_field :search, placeholder: "Search products...", class: "flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"
            = form.submit "Search", class: "bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors"
    :javascript
      function toggleSearch() {
        const overlay = document.getElementById('searchOverlay');
        overlay.classList.toggle('hidden');
      }
    %main.mx-auto.py-0
      - if notice
        .bg-green-100.border.border-green-400.text-green-700.px-4.py-3.rounded.mb-4
          = notice
      - if alert
        .bg-red-100.border.border-red-400.text-red-700.px-4.py-3.rounded.mb-4
          = alert
      = yield
    / Toast root
    #toast-root.toast-root{ data: { controller: "toast" } }
    / Footer
    %footer.bg-brown-black.text-white.py-12.mt-16
      .max-w-7xl.mx-auto.px-4.sm:px-6.lg:px-8
        .grid.grid-cols-1.md:grid-cols-4.gap-8
          / Company Info
          .col-span-1.md:col-span-2
            %h3.mb-4
              %span.text-2xl.font-black.text-white.tracking-tight.inline-block
                %span.inline-block D
                %span.inline-block.mx-1.text-amber-400 A
                %span.inline-block S
              %span.ml-2.text-lg.font-semibold.text-gray-300.uppercase.tracking-wider Club
            %p.text-gray-300.mb-4
              Your premier destination for quality products. We're committed to bringing you the best shopping experience with fast shipping, quality guarantees, and exceptional customer service.
            .flex.space-x-4
              %a.text-gray-300.hover:text-white.transition-colors{:href => "#"}
                %svg.w-6.h-6{:fill => "currentColor", :viewbox => "0 0 24 24"}
                  %path{:d => "M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"}
              %a.text-gray-300.hover:text-white.transition-colors{:href => "#"}
                %svg.w-6.h-6{:fill => "currentColor", :viewbox => "0 0 24 24"}
                  %path{:d => "M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"}
              %a.text-gray-300.hover:text-white.transition-colors{:href => "#"}
                %svg.w-6.h-6{:fill => "currentColor", :viewbox => "0 0 24 24"}
                  %path{:d => "M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.746-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001 12.017.001z"}
          / Quick Links
          %div
            %h4.text-lg.font-semibold.mb-4 Quick Links
            %ul.space-y-2
              %li= link_to "Home", root_path, class: "text-gray-300 hover:text-white transition-colors"
              %li= link_to "Products", products_path, class: "text-gray-300 hover:text-white transition-colors"
              %li= link_to "About Us", "#about", class: "text-gray-300 hover:text-white transition-colors"
              %li= link_to "Contact", "#contact", class: "text-gray-300 hover:text-white transition-colors"
          / Customer Service
          %div
            %h4.text-lg.font-semibold.mb-4 Customer Service
            %ul.space-y-2
              %li
                %a.text-gray-300.hover:text-white.transition-colors{:href => "#"} Shipping Info
              %li
                %a.text-gray-300.hover:text-white.transition-colors{:href => "#"} Returns
              %li
                %a.text-gray-300.hover:text-white.transition-colors{:href => "#"} FAQ
              %li
                %a.text-gray-300.hover:text-white.transition-colors{:href => "#"} Support
        / Bottom Footer
        .border-t.border-gray-700.mt-8.pt-8.text-center
          %p.text-gray-300 Â© 2025 Das Club. All rights reserved.
