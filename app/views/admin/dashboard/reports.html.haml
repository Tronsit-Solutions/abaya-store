.max-w-7xl.mx-auto
  / Header
  .flex.justify-between.items-center.mb-8
    %h1.text-3xl.font-bold.text-brown-black Reports & Analytics
    = link_to "‚Üê Back to Dashboard", admin_root_path, class: "text-amber-600 hover:text-amber-700 font-medium"

  / Date Range Filter
  .bg-white.rounded-lg.shadow-md.p-6.mb-8
    = form_with url: admin_reports_path, method: :get, local: true, class: "flex flex-wrap gap-4 items-end" do |form|
      %div
        %label.block.text-sm.font-medium.text-gray-700.mb-1 Start Date
        = form.date_field :start_date, value: @start_date, class: "px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"
      %div
        %label.block.text-sm.font-medium.text-gray-700.mb-1 End Date
        = form.date_field :end_date, value: @end_date, class: "px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"
      %div
        = form.submit "Apply Filter", class: "bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors"
        = link_to "Reset", admin_reports_path, class: "ml-2 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors"

  / Sales Reports Section
  .mb-8
    %h2.text-2xl.font-bold.text-brown-black.mb-6 Sales Reports
    .grid.grid-cols-1.md:grid-cols-4.gap-6.mb-6
      .bg-white.rounded-lg.shadow-lg.p-6.border-l-4.border-green-500
        %p.text-sm.font-medium.text-gray-600 Total Revenue
        %p.text-3xl.font-bold.text-green-600 $#{@total_revenue}
        %p.text-xs.text-gray-500.mt-1 Period: #{@start_date.strftime("%b %d")} - #{@end_date.strftime("%b %d")}
      .bg-white.rounded-lg.shadow-lg.p-6.border-l-4.border-blue-500
        %p.text-sm.font-medium.text-gray-600 Total Orders
        %p.text-3xl.font-bold.text-blue-600= @total_orders
        %p.text-xs.text-gray-500.mt-1 In selected period
      .bg-white.rounded-lg.shadow-lg.p-6.border-l-4.border-purple-500
        %p.text-sm.font-medium.text-gray-600 Average Order Value
        %p.text-3xl.font-bold.text-purple-600 $#{@average_order_value}
        %p.text-xs.text-gray-500.mt-1 Per order
      .bg-white.rounded-lg.shadow-lg.p-6.border-l-4.border-amber-500
        %p.text-sm.font-medium.text-gray-600 Revenue by Status
        %p.text-sm.text-gray-700.mt-2
          - @revenue_by_status.each do |status, amount|
            %div.flex.justify-between.mb-1
              %span= status.capitalize
              %span.font-semibold $#{amount}

  / Customer Acquisition Section
  .mb-8
    %h2.text-2xl.font-bold.text-brown-black.mb-6 Customer Acquisition
    .grid.grid-cols-1.md:grid-cols-3.gap-6.mb-6
      .bg-white.rounded-lg.shadow-lg.p-6
        %p.text-sm.font-medium.text-gray-600 New Customers
        %p.text-3xl.font-bold.text-brown-black= @new_customers
        %p.text-xs.text-gray-500.mt-1 In selected period
      .bg-white.rounded-lg.shadow-lg.p-6
        %p.text-sm.font-medium.text-gray-600 Total Customers
        %p.text-3xl.font-bold.text-brown-black= @total_customers
        %p.text-xs.text-gray-500.mt-1 All time
      .bg-white.rounded-lg.shadow-lg.p-6
        %p.text-sm.font-medium.text-gray-600 Growth Rate
        %p.text-3xl.font-bold.text-green-600 #{@customer_growth_rate}%
        %p.text-xs.text-gray-500.mt-1 New vs Total

    / Top Customers
    .bg-white.rounded-lg.shadow-lg.p-6.mt-6
      %h3.text-xl.font-semibold.text-brown-black.mb-4 Top Customers (by Revenue)
      - if @top_customers.any?
        %table.min-w-full.divide-y.divide-gray-200
          %thead.bg-gray-50
            %tr
              %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase Customer
              %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase Orders
              %th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase Total Spent
          %tbody.bg-white.divide-y.divide-gray-200
            - @top_customers.each do |customer|
              %tr
                %td.px-6.py-4.whitespace-nowrap.text-sm.text-brown-black
                  = link_to customer.email, admin_customer_path(customer), class: "text-amber-600 hover:text-amber-700"
                %td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= customer.order_count
                %td.px-6.py-4.whitespace-nowrap.text-sm.font-semibold.text-green-600 $#{customer.total_spent}
      - else
        %p.text-gray-500.text-center.py-4 No customer data available

  / Product Performance Section
  .mb-8
    %h2.text-2xl.font-bold.text-brown-black.mb-6 Product Performance
    .grid.grid-cols-1.lg:grid-cols-2.gap-6
      / Top Selling Products
      .bg-white.rounded-lg.shadow-lg.p-6
        %h3.text-xl.font-semibold.text-brown-black.mb-4 Top Selling Products
        - if @top_selling_products.any?
          .divide-y.divide-gray-200
            - @top_selling_products.each_with_index do |product, index|
              .py-3
                .flex.justify-between.items-center
                  %div.flex.items-center
                    %span.text-lg.font-bold.text-gray-400.mr-3= index + 1
                    %div
                      = link_to product.name, admin_product_path(product), class: "text-sm font-semibold text-brown-black hover:text-amber-600"
                      %p.text-xs.text-gray-500 #{product.total_sold} units sold
                  %div.text-right
                    %p.text-sm.font-semibold.text-green-600 $#{product.total_revenue}
        - else
          %p.text-gray-500.text-center.py-4 No product data available

      / Top Revenue Products
      .bg-white.rounded-lg.shadow-lg.p-6
        %h3.text-xl.font-semibold.text-brown-black.mb-4 Top Revenue Products
        - if @product_revenue.any?
          .divide-y.divide-gray-200
            - @product_revenue.each_with_index do |product, index|
              .py-3
                .flex.justify-between.items-center
                  %div.flex.items-center
                    %span.text-lg.font-bold.text-gray-400.mr-3= index + 1
                    %div
                      = link_to product.name, admin_product_path(product), class: "text-sm font-semibold text-brown-black hover:text-amber-600"
                      %p.text-xs.text-gray-500 $#{product.price} per unit
                  %div.text-right
                    %p.text-sm.font-semibold.text-green-600 $#{product.revenue}
        - else
          %p.text-gray-500.text-center.py-4 No product data available

    / Low Performing Products
    - if @low_performing_products.any?
      .bg-white.rounded-lg.shadow-lg.p-6.mt-6
        %h3.text-xl.font-semibold.text-brown-black.mb-4 Low Performing Products
        %p.text-sm.text-gray-600.mb-4 Products with no recent sales
        .grid.grid-cols-1.md:grid-cols-2.lg:grid-cols-3.gap-4
          - @low_performing_products.each do |product|
            .border.border-gray-200.rounded-lg.p-4
              = link_to product.name, admin_product_path(product), class: "text-sm font-semibold text-brown-black hover:text-amber-600"
              %p.text-xs.text-gray-500.mt-1 Stock: #{product.stock}


